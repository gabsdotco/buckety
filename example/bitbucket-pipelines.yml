image: node:16

definitions:
  scripts:
    - script: &scalar |-
        ls -la
        TEST='FOO'
        echo "hello second line"
        echo $TEST

  steps:
    - step: &install
        name: 'Install Dependencies'
        script:
          - npm ci
          - ls -la
          - npm run start

    - step: &export
        name: 'Export Test'
        script:
          - *scalar

pipelines:
  tags:
    '*.*.*':
      - step: *install
      - step: *export

  default:
    - step: *install
    - step: *export

  branches:
    develop:
      - step: *install
    master:
      - step: *install
